<!--
http://atomicrobotdesign.com/blog/htmlcss/move-objects-around-the-canvas-using-the-keyboard-and-jquery/
http://atomicrobotdesign.com/blog_media/canvas_move.html
http://css.dzone.com/articles/back-basics-â€“-using-keyboard
http://javascript.info/tutorial/keyboard-events
-->
<html>
<head>
<script src="jquery-2.1.3.min.js" type="text/javascript"></script>
<style>
canvas {
  display:block;
  margin:auto;
  border:1px dashed black;
}
</style>
<script>
var context;
var rightKey = false;
var leftKey = false;
var upKey = false;
var downKey = false;
var block_x;
var block_y;
var block_h = 30;
var block_w = 30;

function init() {
  context = $('#canvas').get(0).getContext('2d');
  WIDTH = $('#canvas').width();
  HEIGHT = $('#canvas').height();
  block_x = WIDTH / 2 - 15;
  block_y = HEIGHT /2 - 15;
  var FPS = 30;
  setInterval(function() {
	 update();
	 draw();
  }, 1000/FPS);
}
function clearCanvas() {
  context.clearRect(0,0,WIDTH,HEIGHT);
}

function draw() {
  clearCanvas();
  if (rightKey) block_x += 1;
  else if (leftKey) block_x -= 1;
  if (upKey) block_y -= 1;
  else if (downKey) block_y += 1;
  if (block_x <= 0) block_x = 0;
  if ((block_x + block_w) >= WIDTH) block_x = WIDTH - block_w;
  if (block_y <= 0) block_y = 0;
  if ((block_y + block_h) >= HEIGHT) block_y = HEIGHT - block_h;
  context.fillRect(block_x,block_y,block_w,block_h);
}

function onKeyDown(evt) {
  if (evt.keyCode == 39) rightKey = false;
  else if (evt.keyCode == 37) leftKey = false;
  else if (evt.keyCode == 38) upKey = false;
  else if (evt.keyCode == 40) downKey = false;
}

function onKeyUp(evt) {
   if (evt.keyCode == 39)      { rightKey = true; draw5(); rightKey = false; }
   else if (evt.keyCode == 37) { leftKey = true; draw5(); leftKey = false; }
   else if (evt.keyCode == 38) { upKey = true; draw5(); upKey = false; }
   else if (evt.keyCode == 40) { downKey = true; draw5(); downKey = false; }
}

function draw5() {
  for(i=0;i<5;++i){
	 draw();
  }
}

$(document).keydown(onKeyDown);
$(document).keyup(onKeyUp);
</script>
</head>
<body onload="init();">
<canvas id="canvas" width="500" height="400"></canvas>
</body>
</html>
